<!DOCTYPE html>
<html lang="ar">
<head>
  <meta charset="UTF-8" />
  <title>Live Location</title>
  <style>
    body { font-family: Arial; text-align: center; }
    #map { width: 100%; height: 400px; margin-top: 15px; }
  </style>
</head>
<body>

<h2>ğŸ“ Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ù…Ø¨Ø§Ø´Ø±</h2>
<button onclick="start()">Ø§Ø¨Ø¯Ø£ Ù…Ø´Ø§Ø±ÙƒØ© Ø§Ù„Ù…ÙˆÙ‚Ø¹</button>

<div id="map"></div>

<script>
let map, marker, watchId;

function initMap(lat, lng) {
  map = new google.maps.Map(document.getElementById("map"), {
    center: { lat, lng },
    zoom: 16
  });

  marker = new google.maps.Marker({
    position: { lat, lng },
    map: map
  });
}

function start() {
  if (!navigator.geolocation) {
    alert("GPS ØºÙŠØ± Ù…Ø¯Ø¹ÙˆÙ…");
    return;
  }

  watchId = navigator.geolocation.watchPosition(
    pos => {
      const lat = pos.coords.latitude;
      const lng = pos.coords.longitude;

      if (!map) {
        initMap(lat, lng);
      } else {
        const newPos = { lat, lng };
        marker.setPosition(newPos);
        map.setCenter(newPos);
      }

      fetch("/api/location", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ lat, lng })
      });
    },
    err => alert(err.message),
    { enableHighAccuracy: true }
  );
}
</script>

<script async
  src="https://maps.googleapis.com/maps/api/js?key=YOUR_API_KEY">
</script>

</body>
</html>
